from cryptography import x509
from cryptography.hazmat.primitives import serialization

def load_certificate_from_hex_string(hex_string):
    certificate_bytes = bytes.fromhex(hex_string)
    certificate = x509.load_der_x509_certificate(certificate_bytes)
    return certificate

def load_private_key_from_hex_string(hex_string):
    private_key_bytes = bytes.fromhex(hex_string)
    private_key = serialization.load_der_private_key(private_key_bytes, password=None)
    return private_key

# hex_string = "308204e4308202cca00302010202143081270a9242af461d8fedeeb765062e2154976a300d06092a864886f70d01010b0500304c310b300906035504061302434e31263024060355040a0c1d4e49534c204c61622c205473696e6768756120556e69766572736974793115301306035504030c0c4e49534c20526f6f74204341301e170d3234303931383136343731395a170d3234313231373136343731395a30363116301406035504030c0d626f62406261726f6e2e796f75311c301a06092a864886f70d010901160d626f62406261726f6e2e796f7530820122300d06092a864886f70d01010105000382010f003082010a028201010089963302d36a9d0e669202f3a52c261f97a1afb96003417be88cb4f415f0620a69c510f00824d617aaff13f482ecdb075822f1acc634d9277eb68ec4faf1d615a413fbd90b18c253f8acc5b6044c3431b06b0a886cbca0c0713800723f86075d8a3dfad848024b9568644c487c52e9d71b1f4dd88f44c098c1920151d3051df8daba8cfd49ccf8f182402cf98ea1818df971d8d88e419c7104108459642b7507d3574acee89dffe75383f318d5be85a2ea643f2782555731e485c5f560ed1394d6e6ab57428c3c413bca6d39acfd8f401ed74cc2e7a8fe4f8916bf4ce4d6842727a7693938b0adaf478f1dbbca821575ef8dd6d6c7f60669da5c4d19c93bc1dd0203010001a381d33081d0300c0603551d130101ff04023000300e0603551d0f0101ff0404030204f030160603551d250101ff040c300a06082b06010505070304301f0603551d23041830168014b56c99cce28db04db3c0d98f8cd51ebf02c495ce304006082b0601050507010104343032303006082b06010505073002862468747470733a2f2f63612e6261726f6e2e796f752f7075626c69632f6e69736c2e63727430350603551d1f042e302c302aa028a026862468747470733a2f2f63612e6261726f6e2e796f752f7075626c69632f6e69736c2e63726c300d06092a864886f70d01010b0500038202010046e83df57608f6b66b01fc967a9bdedc1a9f736f5cb74be4a4cd0160cdb0721df308ee7a6e8cbc6efebbdb64513e9c643e77df822cb6a1b54f79dd396898a8c4992691980af38996f56f5a7c5f560c7ac619bf4f4ad47d197a94e255ff0945a18f8c5f15a0bc77582797115b2784d83308c9d723580726d10d9c0702e885d8d169242fe28d2f4aee279a371aeed48aaa074ee867f1504a5208dd01697460d901118625da43a1031c2085c991fa9692a61eb4ed9d06b8e7631d91a3b4059b65337a0ce152f41bce2d1723730bc48cb054b8e05a5703835948996825ba16f4f76b40e8db175a8746ab9f70c492f4a01d2e40fdd7160e4664d73ae5df9c2f5e40b5cbe2409ceb156001ee8dfbe30c034f9b3e8ae25a6a3a741347b67d547f6700353e005fcd9a4090ef74fc8e0d2b4143bb2c196db5435cad94bf6ee50c48e19d89053c1bcb6d76e9ec704d481dd525f076bdd33bceff2b926dd870be6f24922469d4b2283cbd98be86406472ff6633d665b7d53e12e7e1c8299aaf64ad52eb405d425b872338e9b360eacf31e6021cb647493159e5c19f3e74d5ed3a131d6f8530c56d12ae3ef656210d7d5e80fecddfdbdbf050fb6e4506bdbc62e4f88500c2f3f66b7b2afb0aef032f25e0aff3fd03d936d2c3ec2a82f8fc29d3c2027f7385ed1e8c71049958e2ba0b8b8879376059c868bcfc70dc94fa29fbb44562ba60e15f"
# # Load the certificate
# certificate = load_certificate_from_hex_string(hex_string)

# # Print details from the certificate (example: subject name)
# print("Certificate Subject:", certificate.subject)
# print("Issuer:", certificate.issuer)

# with open("new_cert.0", "wb") as pem_file:
#     pem_file.write(certificate.public_bytes())


# hex_string2 = "308204a40201000282010100a20cf5d50b26bdbc9b1eb9124448e751395144f10b69e705e270c467ed84369cf8ff35b065334f9b87b949f55b88f0ff964f068b12a945cabd2b4258fd746d6f060696a3d206bd5955ee8ca359e24e72d0209cc4cbf128306b5d8972ac4702a2ec97b019b3de402f097bdb8f10adf79d6b8b9f4ce61c8852075fd94daf2b4f183fc18ae2423da00715041897b6368d19c786b09fa910a58e705ea615e881117f936a500205f6db8b14301a4bfe9ac8a74e516f9cbdae40e154e86a0b4755cbe4dcf610b4bd1d0268a620120d3400c5dd5c6b42876984e3460b0ae1bcb85688a66573852afd49a612b9effca64c2c73236c6159f2fde26f2124c76231327b54b90203010001028201004baf32e7980835888f884756ad36c17691870fe46678c531dde2de104e01b88212d71b2bb1f0478773d9c99d82ed4fe5873d8c684ac46d38b5a62d1c23f00b2655d1a0ec8d2ca1a5c6391e4d32af3c056a8838bfbf22782b3911dc1e8730b91dffd30ea7ca768c528ba2e1d60d2bbb20b6386523c4bb61bdb1fd05a03f26428f69a41fa5cd79a45c08744d087bbeccaeb3863a0f4b6e70405527df5c53eae0a5a627c1b50df1c745a76397afb94471a214dbe8d3ef5454fe2ee733fec864dab22235187fbcda58ee48800c798b6b32375e8daad684748e99c1def2246f5956b6c3c33b695417977640af6879b5e408fc8a374f26814bfe49516c4c6f7ad47dbb02818100d8bb1971a2ab5e3651c8cf3ea78dc8ba8539106f013a6a1420f17e00a8070868ef6ba0dfd03e9f04f4a78f07eaf7f18676d856e338473f4aa32f195edde1ca51e14c03b6a0a00bb9063d4946b39e6cf6e69627a6293917e92b9852f54a225f042ede0be87a1c80152c2d0c389efa4d01a0c00c5b6d17d18e5719ddc632facbaf02818100bf698f0d5cadd22dfe85eebbb8ac89182daee2ea5796e7b69136a566104de7696d12408ac9c449645b8c95420505f8c8979fec67120e76183fa81a7f6fe6811a926379e900a84181aaa9f51803d14a5d148aa0937bad7a4630d5362666770e0db30a300072955e2dd3e6f7f68eccd956032ed7ca814d4b157e2138c30a57781702818019989f3ca8758cbee591cdc81c89c637211cc83013f90e262a6ddaefc0e873b9d0ece92705b51f9aba3a3fce3395ecd4709cc4463993508a44137fef904ce6541d4398fcaca3ba3eb3d9f11984852561538250547371e6bd07050a6725c6416a810e8061886a6d4612dd8f1ff0c6a6e9964e9827040f5814737cfe9035dd20c9028181008e727c2731859a18e885bbb8b02296940bcb4ecb9f0b8abd6f2bffc308f730f4605b68f4e05ad7537c5e0ee5e6df1eda091cd6cd8dbe7d5c66632ff50ecdb7de927abd4b0d562a09d97c4a0de92963f2094b715cd079b5b96eb5fd6a6e6ec362a68f3a51daf415f67cf03230a6ed0400e2b5859a0ac7feccabe5055d00e13f5902818100999a947b6783062894244e97042cd06fa32d78bcf49d60c41c9fba0679a7fb3da67ffec635f2dc4afbab12b6ccd056949b3adbf1d91575fc86aada005bd32c3587a8346939a3773694a2bffb9377a71502ccd0aa91530bedcee5367ae66bc09d61f665f3ce11871a417988c86c926da46ed1cab0e31a2f7fd1aadbf27868359f"
# private_key = load_private_key_from_hex_string(hex_string2)
# pem_data = private_key.private_bytes(encoding=serialization.Encoding.PEM, format=serialization.PrivateFormat.TraditionalOpenSSL, encryption_algorithm=serialization.NoEncryption()  )
# with open("privkey.key", "wb") as pem_file:
#     pem_file.write(pem_data)

if __name__ == '__main__':
    # private_key_hex = input("Enter hexstring of private key:")
    # private_key = load_private_key_from_hex_string(private_key_hex)
    # pem_data = private_key.private_bytes(encoding=serialization.Encoding.PEM, format=serialization.PrivateFormat.TraditionalOpenSSL, encryption_algorithm=serialization.NoEncryption()  )
    # with open("new_privkey.key", "wb") as pem_file:
    #     pem_file.write(pem_data)

    certificate_hex = input("Enter hexstring of cert:")
    print(certificate_hex)
    certificate = load_certificate_from_hex_string(certificate_hex)
    with open("new_cert.crt", "wb") as pem_file:
        pem_file.write(certificate.public_bytes(encoding=serialization.Encoding.PEM))


